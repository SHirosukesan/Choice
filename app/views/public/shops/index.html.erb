<div class="container">
    <div class="row">
       <div class="col-md-10 col-md-offset-1">
        <h2 class="main-title">shop一覧</h2>
              <!-- 検索機能 -->
              <%= form_tag(public_search_path,:method => 'get') do %>
                    <%= text_field_tag :search %>
                    <%= submit_tag 'お店一覧検索', :name => nil %>
              <% end %>
              <br>

              <h1><%= link_to '新規お店作成ボタン', new_public_shop_path %></h1>
              <div>
                    <% @shops.each do |shop| %>
                      <div class="card">
                          <%= link_to public_shop_path(shop.id) do %>
                          	<%= attachment_image_tag shop, :image, format: 'jpeg', size: "300x200", fallback: "no_image.jpg" %>
                          	名前<%= shop.name %>
                          	食べ物種類<%= shop.food %>
                            説明文<%= shop.content %>
                          <% end %>
                                  <!-- いいね機能 -->
                        <% @shops.each do |shop| %>
                          <% if user_signed_in? %>
                            <% if shop.favorited_by?(current_user) %> <!-- ログインしているユーザーがファボしたかどうかで分岐 -->
                                <p><span>お気に入り解除&#9829;: </span><%=link_to shop.favorites.count, public_shop_favorites_path(shop.id), method: :delete %><%=shop.name%></p>
                            <% else %>
                                <p><span>お気に入り登録&#9825;: </span><%=link_to shop.favorites.count, public_shop_favorites_path(shop.id), method: :post %><%=shop.name%></p>
                            <% end %>
                          <% else %>
                            <p><span>お気に入り数: </span><%= shop.favorites.count %></p>
                          <% end %>
                        <% end %>
                    <!-- いいね機能 -->
                    </div>
                    <% end %>
            </div>
       </div>
    </div>
</div>